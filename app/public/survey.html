<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Friend finder survey</title>

    <!-- Linking CSS -->
    <link rel="stylesheet" type="text/css" href="reset.css">
    <link rel="stylesheet" type="text/css" href="style.css">

    <!-- Added link to the jQuery Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

</head>

<body>

    <!-- Match modal, hidden until submission/return -->
    <div id="myModal" class="modal">

        <div class="modal-content">
            <span class="close">&times;</span>
            <p>Recommended Friend:</p>
            <br>
            <h2>
                <div id="modalMatchName">Mickey Mouse</div>
            </h2>
            <img id="modalMatchImg" src="" alt="">
        </div>

    </div>

    <!-- survey page view, desctiption/insctuction/questions/and submit button -->
    <div class="container">

        <div class="friendtitle">
            <h1>Survey</h1>
            <br>
            <h5>Answer 10 questions in the Agree/Disagree format. </h5>
            <h5>Evaluate the statement on the left, then select a rating. </h5>
            <br>
        </div>

        <form>
            <!-- Input for user data -->
            <div class="questions">
                <h2>Your info:</h2>
                <br>
                <h5>Name:</h5>
                <input id=stretchme type="text" name="username" value="Mickey Mouse">
                <br>
                <h5>Picture url:</h5>
                <input id=stretchme type="text" name="picurl" value="http://pngimg.com/uploads/mickey_mouse/mickey_mouse_PNG97.png">
                <br>
            </div>

            <!-- Input question table.. alt-shift-f spreads this out.. leaving it "wet" though -->
            <div class="questiontable">
                <h2>Questions:</h2>
                <br>
                <table>
                    <tr>
                        <th></th>
                        <th>Strongly Disagree</th>
                        <th>Slightly Disagree</th>
                        <th>Neutral</th>
                        <th>Slightly Agree</th>
                        <th>Strongly Disagree</th>
                    </tr>
                    <tr>
                        <td id="qleft">Your mind is always buzzing with unexplored ideas and plans.</td>
                        <td>
                            <input type="radio" name="q1" value="1">
                        </td>
                        <td>
                            <input type="radio" name="q1" value="2">
                        </td>
                        <td>
                            <input type="radio" name="q1" value="3" checked="checked">
                        </td>
                        <td>
                            <input type="radio" name="q1" value="4">
                        </td>
                        <td>
                            <input type="radio" name="q1" value="5">
                        </td>
                    </tr>
                    <tr>
                        <td id="qleft">Generally speaking, you rely more on your experience than your imagination.</td>
                        <td>
                            <input type="radio" name="q2" value="1">
                        </td>
                        <td>
                            <input type="radio" name="q2" value="2">
                        </td>
                        <td>
                            <input type="radio" name="q2" value="3" checked="checked">
                        </td>
                        <td>
                            <input type="radio" name="q2" value="4">
                        </td>
                        <td>
                            <input type="radio" name="q2" value="5">
                        </td>
                    </tr>
                    <tr>
                        <td id="qleft">You find it easy to stay relaxed and focused even when there is some pressure.</td>
                        <td>
                            <input type="radio" name="q3" value="1">
                        </td>
                        <td>
                            <input type="radio" name="q3" value="2">
                        </td>
                        <td>
                            <input type="radio" name="q3" value="3" checked="checked">
                        </td>
                        <td>
                            <input type="radio" name="q3" value="4">
                        </td>
                        <td>
                            <input type="radio" name="q3" value="5">
                        </td>
                    </tr>
                    <tr>
                        <td id="qleft">You rarely do something just out of sheer curiosity.</td>
                        <td>
                            <input type="radio" name="q4" value="1">
                        </td>
                        <td>
                            <input type="radio" name="q4" value="2">
                        </td>
                        <td>
                            <input type="radio" name="q4" value="3" checked="checked">
                        </td>
                        <td>
                            <input type="radio" name="q4" value="4">
                        </td>
                        <td>
                            <input type="radio" name="q4" value="5">
                        </td>
                    </tr>
                    <tr>
                        <td id="qleft">People can rarely upset you.</td>
                        <td>
                            <input type="radio" name="q5" value="1">
                        </td>
                        <td>
                            <input type="radio" name="q5" value="2">
                        </td>
                        <td>
                            <input type="radio" name="q5" value="3" checked="checked">
                        </td>
                        <td>
                            <input type="radio" name="q5" value="4">
                        </td>
                        <td>
                            <input type="radio" name="q5" value="5">
                        </td>
                    </tr>
                    <tr>
                        <td id="qleft">It is often difficult for you to relate to other people’s feelings.</td>
                        <td>
                            <input type="radio" name="q6" value="1">
                        </td>
                        <td>
                            <input type="radio" name="q6" value="2">
                        </td>
                        <td>
                            <input type="radio" name="q6" value="3" checked="checked">
                        </td>
                        <td>
                            <input type="radio" name="q6" value="4">
                        </td>
                        <td>
                            <input type="radio" name="q6" value="5">
                        </td>
                    </tr>
                    <tr>
                        <td id="qleft">In a discussion, truth should be more important than people’s sensitivities.</td>
                        <td>
                            <input type="radio" name="q7" value="1">
                        </td>
                        <td>
                            <input type="radio" name="q7" value="2">
                        </td>
                        <td>
                            <input type="radio" name="q7" value="3" checked="checked">
                        </td>
                        <td>
                            <input type="radio" name="q7" value="4">
                        </td>
                        <td>
                            <input type="radio" name="q7" value="5">
                        </td>
                    </tr>
                    <tr>
                        <td id="qleft">You rarely get carried away by fantasies and ideas.</td>
                        <td>
                            <input type="radio" name="q8" value="1">
                        </td>
                        <td>
                            <input type="radio" name="q8" value="2">
                        </td>
                        <td>
                            <input type="radio" name="q8" value="3" checked="checked">
                        </td>
                        <td>
                            <input type="radio" name="q8" value="4">
                        </td>
                        <td>
                            <input type="radio" name="q8" value="5">
                        </td>
                    </tr>
                    <tr>
                        <td id="qleft">You think that everyone’s views should be respected regardless of whether they are supported by facts
                            or not.</td>
                        <td>
                            <input type="radio" name="q9" value="1">
                        </td>
                        <td>
                            <input type="radio" name="q9" value="2">
                        </td>
                        <td>
                            <input type="radio" name="q9" value="3" checked="checked">
                        </td>
                        <td>
                            <input type="radio" name="q9" value="4">
                        </td>
                        <td>
                            <input type="radio" name="q9" value="5">
                        </td>
                    </tr>
                    <tr>
                        <td id="qleft">You feel more energetic after spending time with a group of people.</td>
                        <td>
                            <input type="radio" name="q10" value="1">
                        </td>
                        <td>
                            <input type="radio" name="q10" value="2">
                        </td>
                        <td>
                            <input type="radio" name="q10" value="3" checked="checked">
                        </td>
                        <td>
                            <input type="radio" name="q10" value="4">
                        </td>
                        <td>
                            <input type="radio" name="q10" value="5">
                        </td>
                    </tr>
                </table>
            </div>
            <div class="questions">
                <button id="myBtn" class="survey" type="submit">
                    <h2>Submit Responses</h2>
                </button>

            </div>

        </form>

        <footer class="footer">
            <div class="container">
                <p>
                    <a href="/api/friends">API Friends Objects</a>
                </p>
            </div>
        </footer>

    </div>
</body>


<script>

    // Modal stuffz
    // Get the modal
    var modal = document.getElementById('myModal');

    // Get the button that opens the modal
    var btn = document.getElementById("myBtn");

    // Get the <span> element that closes the modal
    var closemodal = document.getElementsByClassName("close")[0];


    // When the user clicks on <span> (x), close the modal
    closemodal.onclick = function () {
        modal.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function (event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }

    // When clicking submit button
    $('.survey').on('click', function (event) {
        event.preventDefault();

        if ($('input[name=username]').val().trim() != "" && $('input[name=picurl]').val().trim() != "") {

            var surveyResponse = {
                name: $('input[name=username]').val().trim(),
                picurl: $('input[name=picurl]').val().trim(),
                q1R: $('input[name=q1]:checked').val(),
                q2R: $('input[name=q2]:checked').val(),
                q3R: $('input[name=q3]:checked').val(),
                q4R: $('input[name=q4]:checked').val(),
                q5R: $('input[name=q5]:checked').val(),
                q6R: $('input[name=q6]:checked').val(),
                q7R: $('input[name=q7]:checked').val(),
                q8R: $('input[name=q8]:checked').val(),
                q9R: $('input[name=q9]:checked').val(),
                q10R: $('input[name=q10]:checked').val()
            }

            $.post("/api/friends", surveyResponse)
                .then(function (data) {
                    console.log("wtf");
                    // Grab the result from the AJAX post so that the best match's name and photo are displayed.
                    $("#modalMatchName").text(data.name);
                    $("#modalMatchImg").attr("src", data.photourl);

                    // Show the modal with the best match
                    modal.style.display = "block";

                });

        }
        else {
            alert("Please make sure you entered a name and a picture url!");
        }

    })
</script>

</html>